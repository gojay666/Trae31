"""Add crawl results tables

Revision ID: 61eb1b5f9fcb
Revises: b6bb59402c46
Create Date: 2025-12-04 15:46:07.185705

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '61eb1b5f9fcb'
down_revision = 'b6bb59402c46'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('crawl_result',
    sa.Column('keyword', sa.String(length=100), nullable=False, comment='采集关键词'),
    sa.Column('title', sa.String(length=255), nullable=False, comment='标题'),
    sa.Column('summary', sa.Text(), nullable=True, comment='摘要'),
    sa.Column('cover', sa.String(length=500), nullable=True, comment='封面图片URL'),
    sa.Column('original_url', sa.String(length=500), nullable=False, comment='原始URL'),
    sa.Column('source', sa.String(length=100), nullable=True, comment='来源网站'),
    sa.Column('depth_crawled', sa.Boolean(), nullable=True, comment='是否已深度采集'),
    sa.Column('is_stored', sa.Boolean(), nullable=True, comment='是否已存储到数据库'),
    sa.Column('raw_data', sa.Text(), nullable=True, comment='原始采集数据'),
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.Column('created_by', sa.Integer(), nullable=True),
    sa.Column('updated_by', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['created_by'], ['user.id'], ),
    sa.ForeignKeyConstraint(['updated_by'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('depth_crawl_result',
    sa.Column('crawl_result_id', sa.Integer(), nullable=False, comment='关联的采集结果ID'),
    sa.Column('content', sa.Text(), nullable=True, comment='深度采集内容'),
    sa.Column('images', sa.Text(), nullable=True, comment='采集到的图片列表（JSON格式）'),
    sa.Column('videos', sa.Text(), nullable=True, comment='采集到的视频列表（JSON格式）'),
    sa.Column('links', sa.Text(), nullable=True, comment='页面中的链接列表（JSON格式）'),
    sa.Column('meta_data', sa.Text(), nullable=True, comment='页面元数据（JSON格式）'),
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.Column('created_by', sa.Integer(), nullable=True),
    sa.Column('updated_by', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['crawl_result_id'], ['crawl_result.id'], ),
    sa.ForeignKeyConstraint(['created_by'], ['user.id'], ),
    sa.ForeignKeyConstraint(['updated_by'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('depth_crawl_result')
    op.drop_table('crawl_result')
    # ### end Alembic commands ###
